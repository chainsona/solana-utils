<!doctype html>
<html lang="en" class="antialiased">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"
    />
    <title>Rent Calculator — Solana Utils</title>
    <link rel="icon" type="image/svg+xml" href="/assets/favicon.svg" />
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://code.iconify.design/iconify-icon/1.0.7/iconify-icon.min.js"></script>
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap"
      rel="stylesheet"
    />
    <script>
      tailwind.config = {
        theme: {
          fontFamily: {
            sans: ["Inter", "sans-serif"],
            mono: ["JetBrains Mono", "monospace"],
          },
          extend: {
            colors: {
              background: "#0f172a",
              surface: "#1e293b",
              border: "#334155",
              primary: "#8b5cf6",
            },
          },
        },
      };
    </script>
    <style>
      body {
        background-color: theme("colors.background");
        color: #f1f5f9;
        background-image: radial-gradient(
          circle at 50% 0%,
          #1e293b 0%,
          #0f172a 70%
        );
        min-height: 100vh;
      }
      .mono-box {
        font-family: "JetBrains Mono", monospace;
      }
      .input-area {
        background: #020617;
        border: 1px solid theme("colors.border");
        border-radius: 8px;
        color: #e2e8f0;
        transition: all 0.2s ease;
      }
      .input-area:focus {
        border-color: theme("colors.primary");
        outline: none;
      }
    </style>
  </head>
  <body class="py-6 px-4 flex flex-col items-center">
    <header class="w-full max-w-xl flex justify-between items-center mb-12">
      <div class="flex items-center gap-3">
        <a
          href="/"
          class="w-10 h-10 bg-slate-800 hover:bg-slate-700 rounded-xl flex items-center justify-center transition-colors"
        >
          <iconify-icon
            icon="lucide:arrow-left"
            width="20"
            class="text-slate-400"
          ></iconify-icon>
        </a>
        <div>
          <h1 class="text-xl font-bold tracking-tight text-white">
            Rent Calculator
          </h1>
          <p class="text-xs text-slate-400 font-medium">
            STORAGE COST ESTIMATOR
          </p>
        </div>
      </div>
    </header>

    <main class="w-full max-w-xl space-y-8">
      <section
        class="bg-slate-800/50 border border-slate-700 rounded-xl p-8 text-center"
      >
        <div class="mb-8">
          <label
            class="text-xs font-semibold text-slate-400 uppercase tracking-widest block mb-4"
            >Account Data Size (Bytes)</label
          >
          <div class="relative max-w-xs mx-auto">
            <input
              type="number"
              id="bytesInput"
              class="input-area w-full p-4 text-center text-3xl font-bold text-white mono-box bg-slate-900 border-2 border-slate-700 focus:border-violet-500"
              placeholder="0"
              value="0"
              min="0"
              max="10485760"
            />
            <span
              class="absolute right-4 top-1/2 -translate-y-1/2 text-slate-500 font-mono text-sm"
              >B</span
            >
          </div>
        </div>

        <div class="grid grid-cols-2 gap-4 mb-2">
          <div
            class="bg-slate-900/50 rounded-lg p-4 border border-slate-700/50 overflow-hidden"
          >
            <p class="text-xs text-slate-500 uppercase mb-1">
              Rent Exempt (SOL)
            </p>
            <p
              id="solResult"
              class="text-xl font-bold text-emerald-400 mono-box truncate"
            >
              0.00089
            </p>
          </div>
          <div
            class="bg-slate-900/50 rounded-lg p-4 border border-slate-700/50 overflow-hidden"
          >
            <p class="text-xs text-slate-500 uppercase mb-1">Lamports</p>
            <p
              id="lamportsResult"
              class="text-xl font-bold text-violet-400 mono-box truncate"
            >
              890,880
            </p>
          </div>
        </div>

        <p class="text-[10px] text-slate-500 mt-4">
          Formula: 128 bytes (header) + Data Size × 6,960 lamports/byte +
          890,880 base
        </p>
      </section>

      <div class="space-y-3">
        <h3 class="text-xs font-bold text-slate-500 uppercase px-2">
          Common Sizes
        </h3>
        <div class="grid grid-cols-2 sm:grid-cols-3 gap-3">
          <button
            class="preset-btn bg-slate-800 hover:bg-slate-700 border border-slate-700 p-3 rounded-lg text-left transition-colors"
            data-size="0"
          >
            <span class="block text-xs text-slate-400">Empty Account</span>
            <span class="block text-sm font-mono text-white">0 B</span>
          </button>
          <button
            class="preset-btn bg-slate-800 hover:bg-slate-700 border border-slate-700 p-3 rounded-lg text-left transition-colors"
            data-size="165"
          >
            <span class="block text-xs text-slate-400">Token Account</span>
            <span class="block text-sm font-mono text-white">165 B</span>
          </button>
          <button
            class="preset-btn bg-slate-800 hover:bg-slate-700 border border-slate-700 p-3 rounded-lg text-left transition-colors"
            data-size="82"
          >
            <span class="block text-xs text-slate-400">Mint Account</span>
            <span class="block text-sm font-mono text-white">82 B</span>
          </button>
        </div>
      </div>
    </main>

    <footer class="py-8 px-4 border-t border-slate-800 mt-auto">
      <div
        class="max-w-4xl mx-auto flex flex-col md:flex-row justify-between items-center gap-4"
      >
        <div
          class="inline-flex items-center gap-2 bg-emerald-950/50 border border-emerald-800/50 px-3 py-1.5 rounded-full"
        >
          <iconify-icon
            icon="lucide:shield-check"
            class="text-emerald-400"
            width="14"
          ></iconify-icon>
          <span class="text-[11px] text-emerald-300 font-medium"
            >100% Client-Side — Your Data Stays Private</span
          >
        </div>
        <div class="flex items-center gap-4 text-xs text-slate-500">
          <span>Soona</span>
          <span>•</span>
          <a
            href="https://github.com/chainsona/solana-utils"
            target="_blank"
            class="hover:text-white transition-colors"
            >GitHub</a
          >
        </div>
      </div>
    </footer>

    <script>
      const LAMPORTS_PER_BYTE_YEAR = 3480;
      const EXEMPTION_THRESHOLD = 2.0;
      const HEADER_SIZE = 128;

      function calculateRent(dataSize) {
        const size = parseInt(dataSize) || 0;
        const lamports = Math.floor(
          (HEADER_SIZE + size) * LAMPORTS_PER_BYTE_YEAR * EXEMPTION_THRESHOLD,
        );
        return lamports;
      }

      const input = document.getElementById("bytesInput");
      const solRes = document.getElementById("solResult");
      const lampRes = document.getElementById("lamportsResult");

      function update() {
        let val = parseInt(input.value) || 0;
        // Cap input visually if it exceeds logical limit (e.g. 10MB accounts) to prevent UI break
        if (val > 10_485_760) val = 10_485_760; // 10MB limit

        const lamports = calculateRent(val);
        lampRes.textContent = lamports.toLocaleString();
        solRes.textContent = (lamports / 1_000_000_000).toFixed(5);
      }

      input.addEventListener("input", (e) => {
        // Prevent length overflow
        if (e.target.value.length > 8)
          e.target.value = e.target.value.slice(0, 8);
        update();
      });

      document.querySelectorAll(".preset-btn").forEach((btn) => {
        btn.addEventListener("click", () => {
          input.value = btn.dataset.size;
          update();
        });
      });

      // Init
      update();
    </script>
  </body>
</html>
